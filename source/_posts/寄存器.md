---
title: 寄存器
date: 2021-05-13 18:03:48
update: 2021-05-13 18:03:48
urlname: register
tags:
  - Assembly
  - 8086
categories: Assembly
---

8086 CPU 的所有寄存器都是 16 位的，可以存放两个字节。

8086 CPU 有 14 个寄存器：

AX BX CX DX SI DI SP BP IP CS SS DS ES PSW

- reg: 表示一个寄存器；
- sreg: 表示一个段寄存器。

- reg: ax, bx, cx, dx, ah, al, bh, bl, ch, cl, dh, dl, sp, bp, si, di, ip, psw;
- sreg: ds, ss, cs, es.

<!-- more -->

## 通用寄存器

AX BX CX DX

通常用来存放一般性的数据。

可以分为两个独立使用的 8 位寄存器来用：

- AX 可分为 AH 和 AL
- BX 可分为 BH 和 BL
- CX 可分为 CH 和 CL
- DX 可分为 DH 和 DL

### CX

作用：

1. Debug 将程序从可执行文件加载入内存后，CX 中存放的是程序的长度。
2. 使用 loop 指令实现循环功能时，CX 中存放循环次数。
   CPU 执行 loop 指令的时候，进行两步操作：
   1. (CX) = (CX) - 1;
   2. 判断 CX 中的值：
      - 不为零则转至标号处执行程序；
      - 为零则向下执行。

## 段寄存器

CS DS SS ES

当 8086 CPU 要访问内存时由这 4 个段寄存器提供内存单元的段地址。

在汇编语言中称为段前缀。

### CS 和 IP

指示了 CPU 当前要读取指令的地址。

CS: 代码段寄存器
IP：指令指针寄存器

任意时刻，CPU 将 CS:IP 指向的内容当作指令执行。

EXE 文件中程序的加载过程：

1. 找到一段起始地址为 SA:0000 的容量足够的空闲内存区；
2. 内存区的前 256 个字节中，创建一个称为“程序段前缀（PSP）”的数据区；
   DOS 利用 PSP 来和被加载程序进行通信
3. 内存区的 256 字节处开始，将程序装入，程序的地址被设为 SA+10H:0;
   空闲内存区：SA:0
   PSP 区：SA:0
   程序区：SA+10H:0
4. 将该内存区的段地址存入 ds 中，初始化其它相关寄存器后，设置 CS:IP 指向程序的入口。

### DS

通常用来存放要访问数据的段地址。

### SS 和 SP

栈顶的段地址存放在 SS 中，偏移地址存放在 SP 中。

任意时刻，SS:SP 指向栈顶元素。

### ES

附加段寄存器，存放当前执行程序中一个辅助数据段的段地址。

经常在串传送指令中使用。

## SI 和 DI

SI 和 DI 是与 BX 功能相近的寄存器，但不能够分为两个 8 位寄存器来使用。

## BP

BP 称为指针寄存器，与 SS 连用，为访问现行堆栈段提供方便。通常 BP 寄存器在间接寻址中使用，操作数在堆栈段中，由 SS 段寄存器和 BP 组合形成操作数的地址，即 BP 中存放现行堆栈段中一个数据区的“基址”的偏移量，所以称 BP 为基址指针。

BX、SI、DI 和 BP

1. 在 8086 CPU 中，只有这 4 个寄存器可以用在“[]”中来进行内存单元的寻址。

2. 在 [...] 中，这 4 个寄存器可以单个出现，或只能以 4 种组合出现：
   BX 和 SI、BX 和 DI、BP 和 SI、BP 和 DI

3. 只要在[...]中使用寄存器 BP，而指令中没有显示地给出段地址，段地址就默认在 SS 中。

## PSW

PSW 是 Program Status Word 的缩写，即程序状态字（也叫程序状态寄存器）、标志寄存器 FR（Flag Register）。

详细信息见 [标志寄存器](/flag.html)
